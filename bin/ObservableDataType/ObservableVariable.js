"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 可观察改变变量
 */
class ObservableVariable {
    constructor(value) {
        this._onSet = new Set();
        /**
         * 该变量是否是只读的，默认false
         */
        this.readonly = false;
        //#endregion
        //#region toJSON
        /**
         * 该变量是否允许toJSON，默认true
         */
        this.serializable = true;
        //确保不重复包裹变量
        if (value instanceof ObservableVariable) {
            /**
             * 如果造中使用了return，那么不管是父类还是子类的原型都将不会附加到该对象上
             * 构造函数也就退化成了普通方法
             * 子类构造中的this等于return的返回值
             */
            return value;
        }
        /**
         * 注意：如果要继承ObservableVariable，那么在子类的构造中
         * 在执行super(value)之后一定要判断一下 if(this === value)
         * 如果相等则说明是重复包裹，后面的代码则不应当执行
         */
        this._value = value;
    }
    static observe(value, path) {
        if (path === undefined) {
            return new ObservableVariable(value);
        }
        else if ('string' === typeof path) {
            path = path.split('.');
        }
        for (let index = 0, end = path.length - 1; index < end; index++) {
            value = value[path[index]];
        }
        value[path[path.length - 1]] = new ObservableVariable(value[path[path.length - 1]]);
    }
    get value() {
        return this._value;
    }
    set value(v) {
        if (this.readonly)
            throw new Error(`尝试修改一个只读的 ${this.constructor.name}`);
        if (this._onBeforeSet !== undefined)
            if (this._onBeforeSet(v, this._value, (value) => { v = value; return; }, this) === false)
                return;
        if (this._onSet.size > 0) {
            const oldValue = this._value;
            this._value = v;
            this._onSet.forEach(callback => callback(v, oldValue));
        }
        else
            this._value = v;
    }
    toJSON() {
        return this.serializable ? this._value : undefined;
    }
    on(event, callback) {
        switch (event) {
            case 'set':
                this._onSet.add(callback);
                break;
            case 'beforeSet':
                this._onBeforeSet = callback;
                break;
        }
    }
    once(event, callback) {
        const tempCallback = (...args) => { this.off(event, tempCallback); return callback(...args); };
        this.on(event, tempCallback);
    }
    off(event, callback) {
        switch (event) {
            case 'set':
                callback ? this._onSet.delete(callback) : this._onSet.clear();
                break;
            case 'beforeSet':
                this._onBeforeSet = undefined;
                break;
        }
    }
}
exports.ObservableVariable = ObservableVariable;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9ic2VydmFibGVEYXRhVHlwZS9PYnNlcnZhYmxlVmFyaWFibGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7R0FFRztBQUNIO0lBc0NJLFlBQVksS0FBZ0M7UUFIbEMsV0FBTSxHQUE0QyxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBc0J0RTs7V0FFRztRQUNJLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFzQnhCLFlBQVk7UUFFWixnQkFBZ0I7UUFFaEI7O1dBRUc7UUFDSSxpQkFBWSxHQUFZLElBQUksQ0FBQztRQWxEaEMsV0FBVztRQUNYLElBQUksS0FBSyxZQUFZLGtCQUFrQixFQUFFO1lBQ3JDOzs7O2VBSUc7WUFDSCxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUVEOzs7O1dBSUc7UUFDSCxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztJQUN4QixDQUFDO0lBdkNELE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBVSxFQUFFLElBQVU7UUFDakMsSUFBSSxJQUFJLEtBQUssU0FBUyxFQUFFO1lBQ3BCLE9BQU8sSUFBSSxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUN4QzthQUFNLElBQUksUUFBUSxLQUFLLE9BQU8sSUFBSSxFQUFFO1lBQ2pDLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzFCO1FBRUQsS0FBSyxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUUsR0FBRyxHQUFHLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLEtBQUssR0FBRyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDN0QsS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUM5QjtRQUVELEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksa0JBQWtCLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RixDQUFDO0lBa0NELElBQVcsS0FBSztRQUNaLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRUQsSUFBVyxLQUFLLENBQUMsQ0FBSTtRQUNqQixJQUFJLElBQUksQ0FBQyxRQUFRO1lBQ2IsTUFBTSxJQUFJLEtBQUssQ0FBQyxhQUFhLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUUxRCxJQUFJLElBQUksQ0FBQyxZQUFZLEtBQUssU0FBUztZQUMvQixJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxLQUFRLEVBQUUsRUFBRSxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLEtBQUs7Z0JBQ3ZGLE9BQU87UUFFZixJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxHQUFHLENBQUMsRUFBRTtZQUN0QixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1lBQzdCLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1lBQ2hCLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1NBQzFEOztZQUNHLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFXUyxNQUFNO1FBQ1osT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFDdkQsQ0FBQztJQWdCRCxFQUFFLENBQUMsS0FBVSxFQUFFLFFBQWE7UUFDeEIsUUFBUSxLQUFLLEVBQUU7WUFDWCxLQUFLLEtBQUs7Z0JBQ04sSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQzFCLE1BQU07WUFFVixLQUFLLFdBQVc7Z0JBQ1osSUFBSSxDQUFDLFlBQVksR0FBRyxRQUFRLENBQUM7Z0JBQzdCLE1BQU07U0FDYjtJQUNMLENBQUM7SUFJRCxJQUFJLENBQUMsS0FBVSxFQUFFLFFBQWE7UUFDMUIsTUFBTSxZQUFZLEdBQUcsQ0FBQyxHQUFHLElBQVcsRUFBRSxFQUFFLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQyxPQUFPLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RHLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFJRCxHQUFHLENBQUMsS0FBVSxFQUFFLFFBQWE7UUFDekIsUUFBUSxLQUFLLEVBQUU7WUFDWCxLQUFLLEtBQUs7Z0JBQ04sUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztnQkFDOUQsTUFBTTtZQUVWLEtBQUssV0FBVztnQkFDWixJQUFJLENBQUMsWUFBWSxHQUFHLFNBQWdCLENBQUM7Z0JBQ3JDLE1BQU07U0FDYjtJQUNMLENBQUM7Q0FHSjtBQS9JRCxnREErSUMiLCJmaWxlIjoiT2JzZXJ2YWJsZURhdGFUeXBlL09ic2VydmFibGVWYXJpYWJsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDlj6/op4Llr5/mlLnlj5jlj5jph49cclxuICovXHJcbmV4cG9ydCBjbGFzcyBPYnNlcnZhYmxlVmFyaWFibGU8VD57XHJcblxyXG4gICAgLy8jcmVnaW9uIOmdmeaAgeaWueazlVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5bCG5LiA5Liq5Y+Y6YeP6L2s5o2i5oiQ5Y+v6KeC5a+f5Y+Y6YeP77yM55u45b2T5LqOIG5ldyBPYnNlcnZhYmxlVmFyaWFibGUodmFsdWUpXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBvYnNlcnZlPFQ+KHZhbHVlOiBPYnNlcnZhYmxlVmFyaWFibGU8VD4gfCBUKTogT2JzZXJ2YWJsZVZhcmlhYmxlPFQ+O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlsIblr7nosaHkuK3mjIflrprkvY3nva7nmoTkuIDkuKrlj5jph4/ovazmjaLmiJDlj6/op4Llr5/lj5jph4/vvIzot6/lvoTpgJrov4dgLmDliIblibJcclxuICAgICAqL1xyXG4gICAgc3RhdGljIG9ic2VydmUob2JqZWN0OiBvYmplY3QsIHBhdGg6IHN0cmluZyk6IHZvaWQ7XHJcbiAgICAvKipcclxuICAgICAqIOWwhuWvueixoeS4reaMh+WumuS9jee9rueahOS4gOS4quWPmOmHj+i9rOaNouaIkOWPr+inguWvn+WPmOmHj1xyXG4gICAgICovXHJcbiAgICBzdGF0aWMgb2JzZXJ2ZShvYmplY3Q6IG9iamVjdCwgcGF0aDogc3RyaW5nW10pOiB2b2lkO1xyXG4gICAgc3RhdGljIG9ic2VydmUodmFsdWU6IGFueSwgcGF0aD86IGFueSk6IGFueSB7XHJcbiAgICAgICAgaWYgKHBhdGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGVWYXJpYWJsZSh2YWx1ZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIHBhdGgpIHtcclxuICAgICAgICAgICAgcGF0aCA9IHBhdGguc3BsaXQoJy4nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMCwgZW5kID0gcGF0aC5sZW5ndGggLSAxOyBpbmRleCA8IGVuZDsgaW5kZXgrKykge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlW3BhdGhbaW5kZXhdXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhbHVlW3BhdGhbcGF0aC5sZW5ndGggLSAxXV0gPSBuZXcgT2JzZXJ2YWJsZVZhcmlhYmxlKHZhbHVlW3BhdGhbcGF0aC5sZW5ndGggLSAxXV0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxuICAgIC8vI3JlZ2lvbiDlsZ7mgKdcclxuXHJcbiAgICBwcm90ZWN0ZWQgX3ZhbHVlOiBUOyAgLy/kv53lrZjnmoTlj5jph4/lgLxcclxuICAgIHByb3RlY3RlZCBfb25TZXQ6IFNldDwobmV3VmFsdWU6IFQsIG9sZFZhbHVlOiBUKSA9PiB2b2lkPiA9IG5ldyBTZXQoKTtcclxuICAgIHByb3RlY3RlZCBfb25CZWZvcmVTZXQ6IChuZXdWYWx1ZTogVCwgb2xkVmFsdWU6IFQsIGNoYW5nZVRvOiAodmFsdWU6IFQpID0+IHZvaWQsIG9WYXI6IE9ic2VydmFibGVWYXJpYWJsZTxUPikgPT4gYm9vbGVhbiB8IHZvaWQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IodmFsdWU6IE9ic2VydmFibGVWYXJpYWJsZTxUPiB8IFQpIHtcclxuICAgICAgICAvL+ehruS/neS4jemHjeWkjeWMheijueWPmOmHj1xyXG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9ic2VydmFibGVWYXJpYWJsZSkge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICog5aaC5p6c6YCg5Lit5L2/55So5LqGcmV0dXJu77yM6YKj5LmI5LiN566h5piv54i257G76L+Y5piv5a2Q57G755qE5Y6f5Z6L6YO95bCG5LiN5Lya6ZmE5Yqg5Yiw6K+l5a+56LGh5LiKXHJcbiAgICAgICAgICAgICAqIOaehOmAoOWHveaVsOS5n+WwsemAgOWMluaIkOS6huaZrumAmuaWueazlVxyXG4gICAgICAgICAgICAgKiDlrZDnsbvmnoTpgKDkuK3nmoR0aGlz562J5LqOcmV0dXJu55qE6L+U5Zue5YC8XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDms6jmhI/vvJrlpoLmnpzopoHnu6fmib9PYnNlcnZhYmxlVmFyaWFibGXvvIzpgqPkuYjlnKjlrZDnsbvnmoTmnoTpgKDkuK1cclxuICAgICAgICAgKiDlnKjmiafooYxzdXBlcih2YWx1ZSnkuYvlkI7kuIDlrpropoHliKTmlq3kuIDkuIsgaWYodGhpcyA9PT0gdmFsdWUpXHJcbiAgICAgICAgICog5aaC5p6c55u4562J5YiZ6K+05piO5piv6YeN5aSN5YyF6KO577yM5ZCO6Z2i55qE5Luj56CB5YiZ5LiN5bqU5b2T5omn6KGMXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOivpeWPmOmHj+aYr+WQpuaYr+WPquivu+eahO+8jOm7mOiupGZhbHNlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZWFkb25seSA9IGZhbHNlO1xyXG5cclxuICAgIHB1YmxpYyBnZXQgdmFsdWUoKTogVCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXQgdmFsdWUodjogVCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlYWRvbmx5KVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYOWwneivleS/ruaUueS4gOS4quWPquivu+eahCAke3RoaXMuY29uc3RydWN0b3IubmFtZX1gKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX29uQmVmb3JlU2V0ICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkJlZm9yZVNldCh2LCB0aGlzLl92YWx1ZSwgKHZhbHVlOiBUKSA9PiB7IHYgPSB2YWx1ZTsgcmV0dXJuOyB9LCB0aGlzKSA9PT0gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9vblNldC5zaXplID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHRoaXMuX3ZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IHY7XHJcbiAgICAgICAgICAgIHRoaXMuX29uU2V0LmZvckVhY2goY2FsbGJhY2sgPT4gY2FsbGJhY2sodiwgb2xkVmFsdWUpKTtcclxuICAgICAgICB9IGVsc2VcclxuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB2O1xyXG4gICAgfVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxuICAgIC8vI3JlZ2lvbiB0b0pTT05cclxuXHJcbiAgICAvKipcclxuICAgICAqIOivpeWPmOmHj+aYr+WQpuWFgeiuuHRvSlNPTu+8jOm7mOiupHRydWVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNlcmlhbGl6YWJsZTogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgcHJvdGVjdGVkIHRvSlNPTigpOiBhbnkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6YWJsZSA/IHRoaXMuX3ZhbHVlIDogdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxuICAgIC8vI3JlZ2lvbiDkuovku7bnu5Hlrprmlrnms5VcclxuXHJcbiAgICAvKipcclxuICAgICAqIOW9k+iuvue9ruWAvOeahOaXtuWAmeinpuWPkVxyXG4gICAgICovXHJcbiAgICBvbihldmVudDogJ3NldCcsIGNhbGxiYWNrOiAobmV3VmFsdWU6IFQsIG9sZFZhbHVlOiBUKSA9PiB2b2lkKTogdm9pZDtcclxuICAgIC8qKlxyXG4gICAgICog5Zyo5YC85Y+R55Sf5pS55Y+Y5LmL5YmN6Kem5Y+R77yM6L+U5ZueZmFsc2XooajnpLrpmLvmraLmm7TmlLnvvIzlpoLmnpzopoHmm7TmlLluZXdWYWx1ZeWPr+S7peiwg+eUqGNoYW5nZVRv44CCXHJcbiAgICAgKiDms6jmhI/vvJror6Xlm57osIPlj6rlhYHorrjorr7nva7kuIDkuKrvvIzph43lpI3orr7nva7lsIbopobnm5bkuYvliY3nmoTlm57osIPvvIzlkIzml7borr7nva7nmoTlm57osIPmmK/ku6XlkIzmraXmlrnlvI/miafooYznmoTjgIJcclxuICAgICAqIOazqOaEj++8muWmguaenOimgeaJp+ihjGNoYW5nZVRv77yM5YiZ5bCx5LiN5bqU5YaN6L+U5ZueZmFsc2XkuobvvIzlkKbliJnlsIbkvb/lvpdjaGFuZ2VUb+aXoOaViOOAglxyXG4gICAgICovXHJcbiAgICBvbihldmVudDogJ2JlZm9yZVNldCcsIGNhbGxiYWNrOiAobmV3VmFsdWU6IFQsIG9sZFZhbHVlOiBULCBjaGFuZ2VUbzogKHZhbHVlOiBUKSA9PiB2b2lkLCBvVmFyOiB0aGlzKSA9PiBib29sZWFuIHwgdm9pZCk6IHZvaWQ7XHJcbiAgICBvbihldmVudDogYW55LCBjYWxsYmFjazogYW55KTogYW55IHtcclxuICAgICAgICBzd2l0Y2ggKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NldCc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vblNldC5hZGQoY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlICdiZWZvcmVTZXQnOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5fb25CZWZvcmVTZXQgPSBjYWxsYmFjaztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbmNlKGV2ZW50OiAnc2V0JywgY2FsbGJhY2s6IChuZXdWYWx1ZTogVCwgb2xkVmFsdWU6IFQpID0+IHZvaWQpOiB2b2lkO1xyXG4gICAgb25jZShldmVudDogJ2JlZm9yZVNldCcsIGNhbGxiYWNrOiAobmV3VmFsdWU6IFQsIG9sZFZhbHVlOiBULCBjaGFuZ2VUbzogKHZhbHVlOiBUKSA9PiB2b2lkLCBvVmFyOiB0aGlzKSA9PiBib29sZWFuIHwgdm9pZCk6IHZvaWQ7XHJcbiAgICBvbmNlKGV2ZW50OiBhbnksIGNhbGxiYWNrOiBhbnkpOiBhbnkge1xyXG4gICAgICAgIGNvbnN0IHRlbXBDYWxsYmFjayA9ICguLi5hcmdzOiBhbnlbXSkgPT4geyB0aGlzLm9mZihldmVudCwgdGVtcENhbGxiYWNrKTsgcmV0dXJuIGNhbGxiYWNrKC4uLmFyZ3MpOyB9O1xyXG4gICAgICAgIHRoaXMub24oZXZlbnQsIHRlbXBDYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgb2ZmKGV2ZW50OiAnc2V0JywgY2FsbGJhY2s/OiAobmV3VmFsdWU6IFQsIG9sZFZhbHVlOiBUKSA9PiB2b2lkKTogdm9pZDtcclxuICAgIG9mZihldmVudDogJ2JlZm9yZVNldCcsIGNhbGxiYWNrPzogKG5ld1ZhbHVlOiBULCBvbGRWYWx1ZTogVCwgY2hhbmdlVG86ICh2YWx1ZTogVCkgPT4gdm9pZCwgb1ZhcjogdGhpcykgPT4gYm9vbGVhbiB8IHZvaWQpOiB2b2lkO1xyXG4gICAgb2ZmKGV2ZW50OiBhbnksIGNhbGxiYWNrOiBhbnkpOiBhbnkge1xyXG4gICAgICAgIHN3aXRjaCAoZXZlbnQpIHtcclxuICAgICAgICAgICAgY2FzZSAnc2V0JzpcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrID8gdGhpcy5fb25TZXQuZGVsZXRlKGNhbGxiYWNrKSA6IHRoaXMuX29uU2V0LmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ2JlZm9yZVNldCc6XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkJlZm9yZVNldCA9IHVuZGVmaW5lZCBhcyBhbnk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8jZW5kcmVnaW9uXHJcbn0iXX0=
